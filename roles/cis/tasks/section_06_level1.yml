---
#
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.
#

  - name: 6.1.1 Enable anacron Daemon (Scored)
    shell: rpm -q cronie-anacron
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.1

  - name: 6.1.2 Enable crond Daemon (Scored)
    shell: chkconfig --list cron
    register: cron
    failed_when: >
      '3:on' not in cron.stdout
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.2

  - name: 6.1.3 Set User/Group Owner and Permission on /etc/anacrontab (Scored)
    shell: stat -L -c "%a %u %g" /etc/anacrontab | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.3

  - name: 6.1.4 Set User/Group Owner and Permission on /etc/crontab (Scored)
    shell: stat -L -c "%a %u %g" /etc/crontab | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.4

  - name: 6.1.5 Set User/Group Owner and Permission on /etc/cron.hourly (Scored)
    shell: stat -L -c "%a %u %g" /etc/cron.hourly | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.5

  - name: 6.1.6 Set User/Group Owner and Permission on /etc/cron.daily  (Scored)
    shell: stat -L -c "%a %u %g" /etc/cron.daily | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.6

  - name: 6.1.7 Set User/Group Owner and Permission on /etc/cron.weekly  (Scored)
    shell: stat -L -c "%a %u %g" /etc/cron.weekly | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.7

  - name: 6.1.8 Set User/Group Owner and Permission on /etc/cron.monthly (Scored)
    shell: stat -L -c "%a %u %g" /etc/cron.monthly | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.8

  - name: 6.1.9 Set User/Group Owner and Permission on /etc/cron.d (Scored)
    shell: stat -L -c "%a %u %g" /etc/cron.d | egrep ".00 0 0"
    changed_when: false
    ignore_errors: true
    tags:
      - scored
      - section6.1
      - section6.1.9

  - name: 6.1.10 Restrict at Daemon (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.1
      - section6.1.10

  - name: 6.1.10 Restrict at Daemon (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.1
      - section6.1.10

  - name: 6.1.11 Restrict at/cron to Authorized Users (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.1
      - section6.1.11

  - name: 6.1.11 Restrict at/cron to Authorized Users (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.1
      - section6.1.11

  - name: 6.2.1 Set SSH Protocol to 2 (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.1

  - name: 6.2.2 Set LogLevel to INFO (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.2

  - name: 6.2.3 Set Permissions on /etc/ssh/sshd_config (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.3

  - name: 6.2.4 Disable SSH X11 Forwarding (Scored)
    debug: msg="TODO"
    notify: Reload sshd
    tags:
      - scored
      - section6.2
      - section6.2.4

  - name: 6.2.5 Set SSH MaxAuthTries to 4 or Less (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.5

  - name: 6.2.6 Set SSH IgnoreRhosts to Yes (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.6

  - name: 6.2.7 Set SSH HostbasedAuthentication to No (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.7

  - name: 6.2.8 Disable SSH Root Login (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.8

  - name: 6.2.9 Set SSH PermitEmptyPasswords to No (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.9

  - name: 6.2.10 Do Not Allow Users to Set Environment Options (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.10

  - name: 6.2.11 Use Only Approved Cipher in Counter Mode (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.11

  - name: 6.2.12 Set Idle Timeout Interval for User Login (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.12

  - name: 6.2.12 Set Idle Timeout Interval for User Login (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.12

  - name: 6.2.13 Limit Access via SSH (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.13

  - name: 6.2.13 Limit Access via SSH (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.13

  - name: 6.2.13 Limit Access via SSH (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.13

  - name: 6.2.13 Limit Access via SSH (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.13

  - name: 6.2.14 Set SSH Banner (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.2
      - section6.2.14

  - name: 6.3.1 Upgrade Password Hashing Algorithm to SHA-512 (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.3
      - section6.3.1

  - name: 6.3.1 Upgrade Password Hashing Algorithm to SHA-512 (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.3
      - section6.3.1

  - name: 6.3.2 - 6.3.4 Configure PAM (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.3
      - section6.3.2
      - section6.3.3
      - section6.3.4

  - name: 6.3.2 - 6.3.4 Configure PAM (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.3
      - section6.3.2
      - section6.3.3
      - section6.3.4

  - name: 6.4 Restrict root login to system console (Not Scored)
    debug: msg="Too restrictive for most environments."
    tags:
      - notscored
      - section6.4

  - name: 6.5 Restrict Access to the su Command (Scored)
    debug: msg="TODO"
    tags:
      - scored
      - section6.5
